<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Image Upload & CSV Export</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="styles.css" />
  <script src="https://ucarecdn.com/libs/widget/3.x/uploadcare.full.min.js"></script>
</head>
<body>
  <div class="decorations">
    <div class="circle top-left"></div>
    <div class="square bottom-right"></div>
  </div>

  <main class="container">
    <h1>Upload Your Images</h1>
    <input type="hidden" role="uploadcare-uploader" data-multiple="true" id="uploader" />
    <button onclick="downloadCSV()">ðŸ“¥ Download CSV</button>
  </main>

  <script>
    UPLOADCARE_PUBLIC_KEY = 'demopublickey';

    function downloadCSV() {
      const widget = uploadcare.Widget('[role=uploadcare-uploader]');
      const files = widget.value();
      if (!files || files.length === 0) {
        alert("Please upload at least one image first.");
        return;
      }

      const urls = Array.isArray(files) ? files : [files];
      let csv = 'image\n';
      urls.forEach(url => {
        csv += url + '\n';
      });

      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'images.csv';
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
